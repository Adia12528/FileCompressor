:root {
        --bg-primary: #ffffff;
        --bg-secondary: #f8fafc;
        --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        /* Polished, responsive styles for FileCompressor
             - Glassy app card
             - Refined controls and accessibility
             - Animated dunes (light) and canvas universe (dark)
             - Responsive rules and reduced-motion respect
        */
        --text-primary:#1a202c;
        --text-secondary:#4a5568;
        --border-color: #e6e9f2;
        --shadow-sm: 0 3px 10px rgba(16,24,40,0.06);
        --shadow-md: 0 10px 30px rgba(16,24,40,0.08);
        --shadow-lg: 0 20px 60px rgba(16,24,40,0.12);
        --accent-primary:#9333ea;
        --accent-hover:#7e22ce;
        --accent-light:#f3e8ff;
        --success-bg:#d1fae5;
        --success-border:#6ee7b7;
}

body.dark-mode{
    --bg-primary:#0b1220;
    --bg-secondary:#0f1724;
    --bg-gradient:linear-gradient(135deg,#0b1220 0%,#0a1020 100%);
    --text-primary:#e6eef9;
    --text-secondary:#c0c9d9;
    --border-color: rgba(255,255,255,0.06);
    --shadow-sm: 0 3px 10px rgba(0,0,0,0.45);
    --shadow-md: 0 10px 30px rgba(0,0,0,0.55);
    --shadow-lg: 0 20px 60px rgba(0,0,0,0.65);
    --accent-primary:#9f7aea;
    --accent-hover:#7c3aed;
    --accent-light:#111827;
    --success-bg:#052e1f;
    --success-border:#0ea5a0;
}

*{box-sizing:border-box;margin:0;padding:0}

html,body{height:100%}
body{
    font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    color:var(--text-primary);
    background-image: var(--bg-gradient), radial-gradient(circle at 10% 10%, rgba(255,255,255,0.02), transparent), radial-gradient(circle at 90% 90%, rgba(0,0,0,0.02), transparent);
    background-blend-mode: overlay, normal;
    min-height:100vh;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
}

    /* App card */
    #app{
      width:100%;
      max-width:980px;
      margin:1.5rem auto;
      background: linear-gradient(180deg, rgba(255,255,255,0.96), rgba(255,255,255,0.90));
      border-radius:16px;
      padding:2rem;
      border:1px solid var(--border-color);
      box-shadow:var(--shadow-lg);
      position:relative;
      z-index:100;
      transition: transform .2s ease, box-shadow .2s ease, background .25s ease;
    }
    body.dark-mode #app{
      background: linear-gradient(180deg, rgba(11,18,28,0.7), rgba(6,10,18,0.7));
      border:1px solid rgba(255,255,255,0.03);
    }

    /* Top controls (theme + language + effects) */
    .top-controls{
      position:fixed;right:18px;top:18px;display:flex;gap:10px;align-items:center;z-index:1150;
      background: rgba(255,255,255,0.65);border-radius:14px;padding:6px;border:1px solid rgba(0,0,0,0.06);backdrop-filter: blur(6px) saturate(120%);
    }
    body.dark-mode .top-controls{ background: rgba(6,8,20,0.36); border:1px solid rgba(255,255,255,0.04); }

    .theme-toggle, .effects-toggle, .lang-selector #lang-button{
      display:inline-flex;align-items:center;justify-content:center;gap:6px;border-radius:12px;padding:8px;background:var(--bg-primary);border:1px solid var(--border-color);cursor:pointer;box-shadow:var(--shadow-sm);transition:transform .16s ease, box-shadow .16s ease, background .12s ease;
    }

        /* Visual preset segmented control */
        .preset-control { display:inline-flex; align-items:center; }
        .preset-segment { display:inline-flex; gap:6px; background:transparent; padding:4px; border-radius:12px }
        .preset-btn { display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:10px; border:1px solid var(--border-color); background:var(--bg-primary); color:var(--text-secondary); cursor:pointer; font-weight:600; font-size:0.92rem; transition: transform .12s ease, box-shadow .12s ease, color .12s ease }
        .preset-btn svg { display:block; width:16px; height:16px; opacity:0.92 }
        .preset-btn[aria-pressed="true"] { background: linear-gradient(135deg,var(--accent-primary),var(--accent-hover)); color: white; box-shadow: 0 12px 40px rgba(124,58,237,0.16); transform: translateY(-2px) }
        .preset-btn:focus-visible { outline:none; box-shadow: 0 0 0 4px rgba(124,58,237,0.12); border-color: rgba(124,58,237,0.18) }
        .preset-btn.active { box-shadow: 0 12px 40px rgba(124,58,237,0.16); }

        /* Preset help removed (visual simplification) */
    .theme-toggle svg, .effects-toggle svg{ width:20px;height:20px;display:block }

    .theme-toggle:focus, .effects-toggle:focus, .lang-selector #lang-button:focus{ outline:none; box-shadow:0 0 0 4px rgba(99,102,241,0.12) }
    .theme-toggle:hover, .effects-toggle:hover, .lang-selector #lang-button:hover{ transform:translateY(-3px); box-shadow:var(--shadow-md) }

    /* Language flyout */
    .lang-selector{ position:relative }
    .lang-flyout{ position:absolute; top:110%; right:0; transform:translateY(-6px); visibility:hidden; opacity:0; pointer-events:none; transition:opacity .22s ease, transform .22s ease, visibility 0s .22s }
    .lang-selector.open .lang-flyout, .lang-selector:hover .lang-flyout{ visibility:visible; opacity:1; pointer-events:auto; transform:translateY(0); transition:opacity .22s ease, transform .22s ease, visibility 0s }
    .lang-flyout-content{ background:var(--bg-primary); border:1px solid var(--border-color); padding:8px; border-radius:10px; box-shadow:var(--shadow-lg); min-width:220px; max-height: 400px; overflow-y: auto; -webkit-overflow-scrolling: touch }
    .lang-item-btn{ display:flex;gap:8px;padding:8px;border-radius:8px;width:100%;text-align:left }
    .lang-item-btn:hover{ background:var(--bg-secondary) }

    /* Upload area */
    .cute-upload-area{ display:flex;flex-direction:column;align-items:center;justify-content:center;height:240px;border-radius:12px;border:2px dashed rgba(99,102,241,0.12);background:linear-gradient(180deg,var(--bg-secondary), rgba(255,255,255,0.6));transition:transform .12s ease,border-color .12s ease }
    .cute-upload-area .pulse-animation{ color:var(--accent-primary) }
    .cute-upload-area.active, .cute-upload-area:hover{ transform:translateY(-4px); border-color: rgba(147,51,234,0.9); background: rgba(159,122,234,0.04) }

    /* File info card */
    .bg-violet-50{ background:var(--accent-light) }

    /* Buttons */
    button.primary{
      background:linear-gradient(135deg,var(--accent-primary),var(--accent-hover));color:white;border:none;padding:14px 18px;border-radius:12px;cursor:pointer;font-weight:700;display:inline-flex;align-items:center;gap:10px;box-shadow:0 8px 30px rgba(124,58,237,0.18);transition:transform .16s ease,box-shadow .16s ease
    }
    button.primary:hover{ transform:translateY(-4px); box-shadow:0 18px 50px rgba(124,58,237,0.2) }

    /* Inputs */
    input[type="number"], input[type="text"], select{ padding:12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);background:rgba(255,255,255,0.96);width:100% }
    body.dark-mode input[type="number"], body.dark-mode input[type="text"], body.dark-mode select{ background: rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.04); color:var(--text-primary) }

    /* Loader */
    .loader{ width:44px;height:44px;border-radius:50%;background:conic-gradient(var(--accent-primary), rgba(147,51,234,0.2) 60%);position:relative }
    .loader::after{ content:'';position:absolute;inset:7px;border-radius:50%;background:var(--bg-primary) }

    /* Result section */
    #result-section{ background:var(--success-bg); border:1px solid var(--success-border) }

    /* Background containers */
    #bg-container{ position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden }
    .bg-canvas, .bg-dunes{ position:absolute;inset:0;width:100%;height:100%;display:block }

    /* Dunes (light theme) */
    .bg-dunes{ background: linear-gradient(180deg,#fffaf0 0%,#fff4e6 40%,#ffe9bf 100%); opacity:0; transition:opacity .6s ease, transform .6s ease }
    .light-only{ display:none }
    body:not(.dark-mode) .light-only{ display:block; opacity:1 }
    .bg-dunes .dune{ position:absolute; left:0; right:0; width:140%; height:auto; transform-origin:center bottom }
    .bg-dunes .dune-1{ bottom:-20vh; animation:duneMove 20s ease-in-out infinite; opacity:.98 }
    .bg-dunes .dune-2{ bottom:-26vh; animation:duneMove 26s ease-in-out infinite reverse; opacity:.92 }
    .bg-dunes .dune-3{ bottom:-32vh; animation:duneMove 30s ease-in-out infinite; opacity:.88 }

    @keyframes duneMove{ 0%{ transform:translateX(0) translateY(0) scale(1) } 50%{ transform:translateX(-6%) translateY(-2%) scale(1.02) } 100%{ transform:translateX(0) translateY(0) scale(1) } }

    /* Universe canvas (dark theme) */
    .bg-canvas{ opacity:0; transition:opacity .6s ease, transform .9s cubic-bezier(.2,.9,.2,1); transform:scale(1.02); mix-blend-mode:screen }
    body.dark-mode .dark-only{ display:block; opacity:1 }
    body.dark-mode .bg-canvas{ opacity:1; transform:scale(1) }
    .bg-canvas{ background: radial-gradient(ellipse at center, rgba(20,10,50,0.6) 0%, rgba(6,8,25,0.85) 60%, #00030a 100%) }

    /* Dark theme tweaks for app - ensure headings and body text are readable on dark backgrounds */
    body.dark-mode h1,
    body.dark-mode h2,
    body.dark-mode h3,
    body.dark-mode h4,
    body.dark-mode p,
    body.dark-mode .text-gray-700,
    body.dark-mode .text-gray-500,
    body.dark-mode .text-gray-900,
    body.dark-mode .text-violet-700,
    body.dark-mode .text-violet-600 {
        color: var(--text-primary) !important;
    }

    /* Keep accent links and buttons readable but subtly adjusted for dark */
    body.dark-mode a, body.dark-mode .accent-link { color: var(--accent-primary); }

     /* Ensure commonly used light-background utility classes render dark in dark-mode
         This avoids cases where a component (file info, upload area) remains white while text becomes light */
     body.dark-mode .bg-violet-50 { background: linear-gradient(180deg, rgba(15,20,28,0.56), rgba(6,10,18,0.6)); border-color: rgba(255,255,255,0.03); }
     body.dark-mode .bg-white { background: var(--bg-primary) !important; color: var(--text-primary) !important; border-color: rgba(255,255,255,0.04) !important }
     body.dark-mode .cute-upload-area { background: linear-gradient(180deg, rgba(15,18,28,0.36), rgba(8,10,16,0.28)); border-color: rgba(255,255,255,0.04); }
     body.dark-mode .lang-flyout-content, body.dark-mode .preset-segment, body.dark-mode .preset-btn { background: transparent }

    /* Effects toggle visuals */
    .effects-control{ display:inline-flex;align-items:center;gap:8px }
    .effects-state{ font-size:.78rem;color:var(--text-secondary);background:rgba(0,0,0,0.04);padding:4px 8px;border-radius:9999px;border:1px solid var(--border-color);min-width:34px;text-align:center }
    /* paused-badge removed by user request */

    /* Accessibility and reduced motion */
    @media (prefers-reduced-motion: reduce){ .bg-dunes .dune, .bg-canvas, .loader, .cute-upload-area { animation-play-state:paused !important; transition:none !important } }

    /* Responsive */
    /* Tablet breakpoint: only adjust app padding */
    @media (min-width:641px) and (max-width:1024px){ #app{ padding:1.5rem } }

    /* Utility */
    .hidden{ display:none !important }

    /* Keep old classnames intact for compatibility */
    .bg-violet-50{ background:var(--accent-light) }
    .border-violet-200{ border-color:var(--border-color) }
    .text-violet-700, .text-violet-600{ color:var(--accent-primary) }
    .text-gray-700, .text-gray-500{ color:var(--text-secondary) }
    .text-gray-900{ color:var(--text-primary) }

    /* small polish for header */
    header{ position:relative }
    header::after{ content:''; position:absolute; left:-40px; top:-40px; width:220px;height:220px;border-radius:50%; background: radial-gradient(circle at 30% 30%, rgba(147,51,234,0.08), transparent 30%); filter: blur(40px); opacity:.9; pointer-events:none }
    body.dark-mode header::after{ background: radial-gradient(circle at 30% 30%, rgba(159,122,234,0.06), transparent 30%) }
    

/* paused-badge removed by user request */

/* Position flyout under the language button when in the top-controls */
.top-controls .lang-flyout {
    top: calc(100% + 6px);
    right: 0;
    left: auto;
    transform: translateY(0);
    width: 260px;
}

/* Make the language button align visually with the theme toggle */
.top-controls .lang-selector #lang-button {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    height: 50px;
    padding: 0 10px;
    border-radius: 9999px;
}

/* Ensure the theme toggle and language selector don't overlap on small screens */
    /* ======================================== */
    /* MOBILE-FIRST RESPONSIVE (≤ 900px)      */
    /* ======================================== */
    @media (max-width: 900px) {
        /* Move top-controls into app as a fixed navbar */
        .top-controls.moved-to-app {
            position: fixed !important;
            top: calc(env(safe-area-inset-top, 8px) + 8px) !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            width: calc(100% - 2rem) !important;
            max-width: 820px !important;
            margin: 0 !important;
            padding: 10px 14px !important;
            border-radius: 12px !important;
            box-shadow: 0 10px 30px rgba(2,6,23,0.12) !important;
            background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.95)) !important;
            z-index: 2400 !important;
            display: flex !important;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            animation: slideDownFade .22s ease both;
        }
        body.dark-mode .top-controls.moved-to-app {
            background: linear-gradient(180deg, rgba(11,18,28,0.88), rgba(8,12,22,0.82)) !important;
            border: 1px solid rgba(255,255,255,0.08) !important;
        }

        /* Hide presets and effects in top-controls; they're moved to the flyout */
        .top-controls > .preset-control,
        .top-controls > .effects-control {
            display: none !important;
        }

        /* Show the three-dot menu button */
        .mobile-menu-button {
            display: inline-flex !important;
            align-items: center;
            justify-content: center;
            width: 42px;
            height: 42px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
            cursor: pointer;
            z-index: 2220;
            position: relative;
            pointer-events: auto;
        }
        .mobile-menu-button:focus {
            outline: none;
            box-shadow: 0 0 0 4px rgba(99,102,241,0.12);
        }
        .mobile-menu-button:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }
        .mobile-menu-button svg {
            width: 18px;
            height: 18px;
        }

        /* Mobile flyout menu styling */
        .mobile-menu-flyout {
            position: fixed !important;
            top: calc(env(safe-area-inset-top, 12px) + 64px) !important;
            left: 50% !important;
            transform: translateX(-50%) translateY(0) !important;
            width: clamp(240px, 82%, 360px) !important;
            max-width: calc(100% - 32px) !important;
            max-height: calc(100vh - (env(safe-area-inset-top, 12px) + 96px)) !important;
            overflow-y: auto;
            background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.95)) !important;
            border: 1px solid var(--border-color) !important;
            box-shadow: 0 28px 56px rgba(2,6,23,0.42) !important;
            border-radius: 14px !important;
            padding: 10px !important;
            z-index: 2350 !important;
            backdrop-filter: blur(6px) !important;
            -webkit-backdrop-filter: blur(6px) !important;
        }
        body.dark-mode .mobile-menu-flyout {
            background: linear-gradient(180deg, rgba(11,18,28,0.92), rgba(8,12,22,0.88)) !important;
            border: 1px solid rgba(255,255,255,0.08) !important;
        }

        /* Show/hide flyout based on aria-hidden */
        .mobile-menu-flyout[aria-hidden="true"] {
            display: none !important;
            visibility: hidden;
        }
        .mobile-menu-flyout[aria-hidden="false"] {
            display: block !important;
            visibility: visible;
            opacity: 1;
        }

        /* Caret pointing up from flyout to the button */
        .mobile-menu-flyout::after {
            content: '';
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%) rotate(45deg);
            width: 16px;
            height: 16px;
            background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.95));
            border-left: 1px solid rgba(0,0,0,0.04);
            border-top: 1px solid rgba(0,0,0,0.04);
            box-shadow: -2px -2px 6px rgba(2,6,23,0.06);
            z-index: -1;
        }
        body.dark-mode .mobile-menu-flyout::after {
            background: linear-gradient(180deg, rgba(11,18,28,0.92), rgba(8,12,22,0.88));
        }

        /* Flyout inner content - horizontal scroll on small phones */
        .mobile-menu-inner {
            display: flex !important;
            flex-direction: column !important;
            gap: 6px !important;
            padding: 4px !important;
            align-items: stretch;
            width: 100%;
        }

        /* Preset control wrapper inside flyout */
        .mobile-menu-inner .preset-control {
            display: flex !important;
            flex-direction: column !important;
            width: 100% !important;
        }

        .mobile-menu-inner .preset-segment {
            display: flex !important;
            flex-direction: column !important;
            gap: 6px !important;
            width: 100% !important;
            padding: 0 !important;
        }

        /* Preset buttons inside flyout */
        .mobile-menu-inner .preset-btn {
            display: flex !important;
            width: 100% !important;
            padding: 12px 14px !important;
            text-align: left !important;
            justify-content: flex-start !important;
            align-items: center !important;
            border-radius: 10px !important;
            margin: 0 !important;
            background: var(--bg-primary) !important;
            border: 1px solid var(--border-color) !important;
            color: var(--text-secondary) !important;
            font-weight: 600 !important;
            gap: 10px !important;
            white-space: nowrap !important;
        }

        /* Active preset button in mobile */
        .mobile-menu-inner .preset-btn[aria-pressed="true"] {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-hover)) !important;
            color: white !important;
            border-color: transparent !important;
        }

        /* Effects toggle inside flyout */
        .mobile-menu-inner .effects-control {
            width: 100% !important;
            display: flex !important;
            justify-content: flex-start !important;
        }

        .mobile-menu-inner #effects-toggle {
            width: 100% !important;
            padding: 12px 14px !important;
            text-align: left !important;
            justify-content: flex-start !important;
            border-radius: 10px !important;
            margin: 0 !important;
            background: var(--bg-primary) !important;
            border: 1px solid var(--border-color) !important;
            color: var(--text-secondary) !important;
            display: flex !important;
            align-items: center !important;
            gap: 10px !important;
        }

        /* Dark mode text colors for mobile menu buttons */
        body.dark-mode .mobile-menu-inner .preset-btn {
            background: rgba(255, 255, 255, 0.03) !important;
            border-color: rgba(255, 255, 255, 0.08) !important;
            color: var(--text-primary) !important;
        }

        body.dark-mode .mobile-menu-inner #effects-toggle {
            background: rgba(255, 255, 255, 0.03) !important;
            border-color: rgba(255, 255, 255, 0.08) !important;
            color: var(--text-primary) !important;
        }

        body.dark-mode .mobile-menu-inner .preset-btn[aria-pressed="true"] {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-hover)) !important;
            color: white !important;
            border-color: transparent !important;
        }

        /* Focus styles for keyboard users in flyout */
        .mobile-menu-flyout :focus {
            outline: 2px solid rgba(99,102,241,0.95);
            outline-offset: 2px;
            border-radius: 8px;
        }

        /* App card gets padding to avoid navbar overlap */
        #app {
            margin-top: calc(env(safe-area-inset-top, 8px) + 84px) !important;
            padding-top: 1rem !important;
        }

        /* Adjust upload area on mobile */
        .cute-upload-area {
            height: auto !important;
            min-height: 10rem;
            padding: 1rem !important;
        }

        /* Compact top-controls when moved to app */
        .top-controls.moved-to-app .theme-toggle,
        .top-controls.moved-to-app .lang-selector {
            flex: 0 0 auto;
        }

        /* Order: theme + language on left, three-dot on right */
        .top-controls.moved-to-app > .theme-toggle {
            order: 1;
            margin-right: 8px;
        }
        .top-controls.moved-to-app > .lang-selector {
            order: 2;
        }
        .top-controls.moved-to-app > .mobile-menu {
            order: 3;
            margin-left: auto;
        }

        /* Fix language flyout positioning in mobile view */
        .top-controls.moved-to-app .lang-selector {
            position: static;
        }
        
        .top-controls.moved-to-app .lang-flyout {
            position: fixed !important;
            top: calc(env(safe-area-inset-top, 12px) + 56px) !important;
            left: 50% !important;
            right: auto !important;
            transform: translateX(-50%) translateY(0) !important;
            width: clamp(200px, 80%, 300px) !important;
            max-width: calc(100% - 32px) !important;
            max-height: 60vh !important;
            z-index: 2400 !important;
        }

        .top-controls.moved-to-app .lang-flyout-content {
            max-height: 60vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        /* Responsive adjustments for dunes animation */
        .bg-dunes .dune-1{ bottom: -10vh; }
        .bg-dunes .dune-2{ bottom: -14vh; }
        .bg-dunes .dune-3{ bottom: -18vh; }

        /* Reduce body overflow on mobile */
        html, body {
            overflow-x: hidden;
        }
    }

    /* Slide-down animation for navbar */
    @keyframes slideDownFade {
        from {
            opacity: 0;
            transform: translateX(-50%) translateY(-8px);
        }
        to {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
    }

    /* Tablet breakpoint: larger padding */
    @media (min-width: 641px) and (max-width: 1024px) {
        #app { padding: 1.5rem !important; }
        .cute-upload-area { min-height: 12rem; }
    }
